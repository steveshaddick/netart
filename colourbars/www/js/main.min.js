if(typeof console=="undefined"){console={log:function(){}};}(function(){var lastTime=0;var vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"];}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(id){clearTimeout(id);};}}());var GLOBAL={revert:false,lastRevert:0};var ResizeHandler=(function(){var callback=null;var needResize=false;var resizeTimeout=null;function resize(_callback){if(typeof callback=="undefined"){return;}callback=_callback;$(window).resize(windowResize);}function windowResize(){if(needResize){return;}needResize=true;if(!resizeTimeout){resizeHandler();}}function resizeHandler(){if(needResize){resizeTimeout=setTimeout(resizeHandler,50);}else{resizeTimeout=null;return;}callback();needResize=false;}function remove(){$(window).unbind("resize",windowResize);}return{resize:resize,remove:remove};}());var ChangingBar=function(width,height,x,y,colour,ctx,isChangeWidth){this.base={width:width,height:height,x:x,y:y};this.adjusted={width:width,x:x};this.width=width;this.height=height;this.x=x;this.y=y;this.isRevert=false;this.originalColour=colour;this.colour={hue:this.originalColour.hue,sat:this.originalColour.sat,light:this.originalColour.light};this.isChangeWidth=isChangeWidth;this.ctx=ctx;this.maxWidthChange=this.adjusted.width*0.1;this.changeWidth={time:(new Date()).getTime()+((Math.random()*10000)),changing:false,widthAmount:(Math.random()<0.5)?1:-1,xAmount:0,ticks:0,totalTicks:0};this.changeColour={time:(new Date()).getTime()+((Math.random()*10000)),changing:false,hueAmount:0,satAmount:0,lightAmount:0,ticks:0,totalTicks:0};this.lockWidth=((this.base.x==548.4)&&(this.base.y==360));if(this.lockWidth){this.maxWidthChange*=0.5;}};ChangingBar.prototype.resize=function(multiplier){this.y=Math.floor(this.base.y*multiplier);this.height=Math.floor((this.base.height+this.base.y)*multiplier)-this.y;var widthRatio=this.width/this.adjusted.width;this.adjusted.width=this.base.width*multiplier;this.adjusted.x=this.base.x*multiplier;this.width=this.adjusted.width*widthRatio;this.x=this.adjusted.x-((this.width-this.adjusted.width)*0.5);this.maxWidthChange=this.adjusted.width*0.1;this.ctx.fillStyle="hsl("+this.colour.hue+", "+this.colour.sat+"%, "+this.colour.light+"%)";this.ctx.fillRect(this.x,this.y,this.width,this.height);};ChangingBar.prototype.change=function(time){if(GLOBAL.revert&&!this.isRevert){if(this.isChangeWidth){this.changeWidth.changing=true;this.changeWidth.ticks=0;this.changeWidth.time=time+10000+((Math.random()*10000)+10000);this.changeWidth.totalTicks=10000*0.025;this.changeWidth.widthAmount=(this.adjusted.width-this.width)/this.changeWidth.totalTicks;this.changeWidth.xAmount=(this.adjusted.x-this.x)/this.changeWidth.totalTicks;}this.changeColour.changing=true;this.changeColour.ticks=0;this.changeColour.time=time+10000+((Math.random()*10000)+10000);this.changeColour.totalTicks=10000*0.025;if(this.originalColour.sat==100){this.changeColour.hueAmount=(this.originalColour.hue-this.colour.hue)/this.changeColour.totalTicks;}else{this.changeColour.lightAmount=(this.originalColour.light-this.colour.light)/this.changeColour.totalTicks;}this.isRevert=true;console.log(GLOBAL.lastRevert,"reverting");}if(this.isChangeWidth){if(!this.changeWidth.changing){if(this.changeWidth.time<=time){this.changeWidth.changing=true;this.changeWidth.ticks=0;var animationTime=(Math.random()*15000)+10000;this.changeWidth.time=time+animationTime+((Math.random()*10000)+10000);var targetWidth;var targetX;if(this.changeWidth.widthAmount>0){targetWidth=this.adjusted.width-((Math.random()*this.maxWidthChange)+this.maxWidthChange);}else{targetWidth=this.adjusted.width+((Math.random()*this.maxWidthChange)+this.maxWidthChange);}if(!this.lockWidth){targetX=this.adjusted.x+((this.adjusted.width-targetWidth)*0.5);}else{targetX=this.adjusted.x+(this.adjusted.width-targetWidth);}this.changeWidth.totalTicks=animationTime*0.025;this.changeWidth.widthAmount=(targetWidth-this.width)/this.changeWidth.totalTicks;this.changeWidth.xAmount=(targetX-this.x)/this.changeWidth.totalTicks;if((this.base.x==91.4)&&(this.base.y==0)){}}}}if(!this.changeColour.changing){if(this.changeColour.time<=time){this.changeColour.changing=true;this.changeColour.ticks=0;var animationTime=(Math.random()*15000)+10000;this.changeColour.time=time+animationTime+((Math.random()*10000)+10000);this.changeColour.totalTicks=animationTime*0.025;if(this.originalColour.sat==100){var targetHue;if(this.changeColour.hueAmount>0){targetHue=this.originalColour.hue-((Math.random()*10)+10);}else{targetHue=this.originalColour.hue+((Math.random()*10)+10);}this.changeColour.hueAmount=(targetHue-this.colour.hue)/this.changeColour.totalTicks;}else{var targetLight;if(this.changeColour.lightAmount>0){targetLight=this.originalColour.light-((Math.random()*2)+2);}else{targetLight=this.originalColour.light+((Math.random()*2)+2);}this.changeColour.lightAmount=(targetLight-this.colour.light)/this.changeColour.totalTicks;}if((this.base.x==0)&&(this.base.y==0)){}}}if((!this.changeWidth.changing)&&(!this.changeColour.changing)){return;}this.ctx.clearRect(this.x-1,this.y,this.width+2,this.height);if(this.changeWidth.changing){this.width+=this.changeWidth.widthAmount;this.x+=this.changeWidth.xAmount;this.changeWidth.ticks++;if(this.changeWidth.ticks>this.changeWidth.totalTicks){this.changeWidth.changing=false;if(this.isRevert){this.isRevert=false;}}}if(this.changeColour.changing){this.colour.hue+=this.changeColour.hueAmount;this.colour.light+=this.changeColour.lightAmount;this.changeColour.ticks++;if(this.changeColour.ticks>this.changeColour.totalTicks){this.changeColour.changing=false;if(this.isRevert){this.isRevert=false;}}}this.ctx.fillStyle="hsl("+Math.round(this.colour.hue)+", "+this.colour.sat+"%, "+Math.round(this.colour.light)+"%)";this.ctx.fillRect(this.x,this.y,this.width,this.height);};var Main=(function(){var $mainWrapper;var $window;var $colourBars=[];var changingBars=[];var widthBars=[];var cbCount=0;var topCanvas;var bottomCanvas;var time=new Date().getTime();var col=40;function init(){$mainWrapper=$("#canvasWrapper");$window=$(window);topCanvas=document.getElementById("topCanvas");bottomCanvas=document.getElementById("bottomCanvas");var ctxTop=topCanvas.getContext("2d");var ctxBottom=bottomCanvas.getContext("2d");changingBars.push(new ChangingBar(138,320,0,0,{hue:0,sat:0,light:80},ctxBottom,false));changingBars.push(new ChangingBar(91.4,320,91.4,0,{hue:60,sat:100,light:50},ctxTop,true));changingBars.push(new ChangingBar(182,320,137,0,{hue:180,sat:100,light:50},ctxBottom,false));changingBars.push(new ChangingBar(91.4,320,274.2,0,{hue:120,sat:100,light:50},ctxTop,true));changingBars.push(new ChangingBar(182,320,320,0,{hue:300,sat:100,light:50},ctxBottom,false));changingBars.push(new ChangingBar(91.4,320,457,0,{hue:0,sat:100,light:50},ctxTop,true));changingBars.push(new ChangingBar(138,320,502,0,{hue:240,sat:100,light:50},ctxBottom,false));changingBars.push(new ChangingBar(138,40,0,320,{hue:240,sat:100,light:50},ctxBottom,false));changingBars.push(new ChangingBar(91.4,40,91.4,320,{hue:0,sat:0,light:7},ctxTop,true));changingBars.push(new ChangingBar(182,40,137,320,{hue:300,sat:100,light:50},ctxBottom,false));changingBars.push(new ChangingBar(91.4,40,274.2,320,{hue:0,sat:0,light:7},ctxTop,true));changingBars.push(new ChangingBar(182,40,320,320,{hue:180,sat:100,light:50},ctxBottom,false));changingBars.push(new ChangingBar(91.4,40,457,320,{hue:0,sat:0,light:7},ctxTop,true));changingBars.push(new ChangingBar(138,40,502,320,{hue:0,sat:0,light:80},ctxBottom,false));changingBars.push(new ChangingBar(172,120,0,360,{hue:200,sat:84,light:19},ctxBottom,false));changingBars.push(new ChangingBar(114.25,120,114.25,360,{hue:0,sat:0,light:100},ctxTop,true));changingBars.push(new ChangingBar(228,120,172,360,{hue:268,sat:100,light:25},ctxBottom,false));changingBars.push(new ChangingBar(114.25,120,342.75,360,{hue:0,sat:0,light:7},ctxTop,true));changingBars.push(new ChangingBar(102,120,400,360,{hue:0,sat:0,light:0},ctxBottom,false));changingBars.push(new ChangingBar(30.467,120,487.467,360,{hue:0,sat:0,light:7},ctxTop,true));changingBars.push(new ChangingBar(92,120,502,360,{hue:0,sat:0,light:15},ctxBottom,false));changingBars.push(new ChangingBar(91.4,120,548.4,360,{hue:0,sat:0,light:7},ctxTop,true));drawBars();ResizeHandler.resize(drawBars);tick();}function test(ctx){col++;ctx.clearRect(0,0,640,480);var light=col/100;var lightRound=Math.floor(light);var lightRemain=light-lightRound;ctx.fillStyle="hsl(0, 0%, "+lightRound+"%)";console.log("hsl("+col/10+", 100%, 50%)");ctx.fillRect(0,0,640,480);console.log("hsla(0, 0%, "+lightRound+"%, "+lightRemain+")");}function drawBars(){var height=$mainWrapper.height();if(height<240){height=240;}var width=height*1.3333333;var multiplier=width/640;topCanvas.width=bottomCanvas.width=width;topCanvas.height=bottomCanvas.height=height;topCanvas.style.left=(($mainWrapper.width()*0.5)-(topCanvas.width*0.5))+"px";bottomCanvas.style.left=(($mainWrapper.width()*0.5)-(bottomCanvas.width*0.5))+"px";var ctxBottom=bottomCanvas.getContext("2d");ctxBottom.fillStyle="#131313";ctxBottom.fillRect(0,0,bottomCanvas.width,bottomCanvas.height);var ctxTop=topCanvas.getContext("2d");ctxTop.clearRect(0,0,topCanvas.width,topCanvas.height);for(var i=0;i<22;i++){changingBars[i].resize(multiplier);}}function tick(){setTimeout(tick,40);var date=new Date();var now=date.getTime();var minutes=0,seconds=0;minutes=date.getMinutes();seconds=date.getSeconds();if(seconds==50){if(GLOBAL.lastRevert!=minutes){GLOBAL.lastRevert=minutes;GLOBAL.revert=true;}}for(var i=0;i<22;i++){changingBars[i].change(now);}GLOBAL.revert=false;}return{init:init};}());